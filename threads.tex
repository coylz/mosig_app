\documentclass[a4paper,10pt]{article}

%%%% PRATIQUE POUR LES ALINEAS CHIANTS
\usepackage{indentfirst}

%%%% POUR L'OPTION LABEL= %%%
\usepackage{enumitem}

\usepackage{graphicx}
\usepackage{titling}
\usepackage{listings}
\lstset{%
  basicstyle=\scriptsize\sffamily,%
  commentstyle=\footnotesize\ttfamily,%
  frameround=trBL,
  frame=single,
  breaklines=true,
  showstringspaces=false,
  numbers=left,
  numberstyle=\tiny,
  numbersep=10pt,
  keywordstyle=\bf
}
\newcommand{\subtitle}[1]{%
  \posttitle{%
    \par\end{center}
    \begin{center}\large#1\end{center}
    \vskip0.5em}%
}
\title{Operating Systems}
\subtitle{Threads}
\author{}
\date{04/11/2014}

\begin{document}
\maketitle
%\begin{abstract}
%This document is our report of the first practical session. It contains our design choices along with the results of our implementation.	
%\end{abstract}


\section{Introduction}

A thread is an execution context that belong to a process.
A process might contain several threads which share some resources : memory and file descriptors.

Sometimes called lightweight process.

\vspace{0.2cm}
\begin{minipage}{0.4\textwidth}
    \begin{center}
        process with single thread
        \begin{tabular}{|c|c|c|}
            \hline
            code & data & files \\
            \hline
            register & & stack \\
            & \vdots & \\
            & \vdots & \\
            \hline
        \end{tabular}
    \end{center}
\end{minipage}
\begin{minipage}{0.4\textwidth}
    \begin{center}
        process with multiple threads
        \begin{tabular}{|c|c|c|}
            \hline
            code & data & files \\
            \hline
            registers & registers & registers \\
            stack& stack & stack \\
            \vdots & \vdots & \vdots \\
            \vdots & \vdots & \vdots \\
            \hline
        \end{tabular}
    \end{center}
\end{minipage}
\vspace{0.2cm}

Advantages :
\begin{enumerate}[label=-]
	\item Lighter management (especially context switch)
	\item Take advantage of concurrency within a process ( eg can perform a computation during a blocking system call in another thread).
	\item Communication between threads is easier/more efficient than IPC( Inter Process Communication) between processes.
\end{enumerate}

Example : Webserver
The main thread can listen to connextions while other threads handle requests
Accesses to Webserver data can be performed concurrently and overlapped with computations

\section{Thread Models}

Threads might be :\\

Preemptive : threads might be interrupted asynchronously to switch to another thread. \\
Cooperative : the thread itself release the PCU to let another thread be scheduled.\\

Advantages/Drawbacks :\\

For preemptive : \\
Insensitive to misbehaving threads.\\
Can take advantage of multiple CPUS.\\
higher cost (context switch) \\

For cooperative :\\
easier to programm and debug  because not sensitive to data races ( will be explained later) \\
can only take advantage of a single CPU \\
more efficient


\section{Implementation}

The implementation can be performed by using the kernel, in that case the implementation
is similar to processes implementation :

\begin{itemize}
\item the kernel itself performs threads scheduling.
\item threads management : creation, destruction and preemption managed by the kernel.
\item can be implemented almost like processes, eg in Linux :
\begin{itemize}
\item processes and threads are tasks.
\item they have different attributes, memory is shared for threeads
\item scheduled using the same scheduler
\end{itemize}
\end{itemize}

The implementation might also be completely in a user-level process under the form of a library :

\begin{itemize}
\item creation, destruction are just fonctions of the library (which manage an internal list of threads)
\item context switch :
\begin{itemize}
\item preemptive model : rely of preemption mechanism provided by  the kernel such as signals (setitimer/sigalarm)
\item cooperative model : rely on a function 'yield' provided by the library and called by the thread itself
\item both cases : most blocking functions are redefined to put blocking thread in a waiting queue and let the scheduler decide on another thread to execute. This includes : read, write, accept, connect, ....
\end{itemize}
\end{itemize}

% schéma bizarre là ! titre : "within the kernel "


 \end{document}
